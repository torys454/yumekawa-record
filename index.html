<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>‚úß Â§ú„ÅÆ„É™„ÉÅ„É•„Ç¢„É´ ‚úß</title>
  <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      /* „ÅÜ„Åï„ÅéÔºà„Éá„Éï„Ç©„É´„ÉàÔºâ */
      --pink-light: #ffeef8;
      --pink-main: #ffb6d9;
      --pink-dark: #ff8ac4;
      --lavender: #e8d4f0;
      --lavender-dark: #c9a8d8;
      --bg-dark: #1a1520;
      --bg-mid: #2d1f3d;
      --text-light: #fff0f8;
      --text-muted: #c4b8cc;
      --mascot-body: radial-gradient(ellipse at 30% 30%, #ffffff 0%, #f0e8f8 50%, #e8d8f0 100%);
      --mascot-ear-inner: linear-gradient(180deg, var(--pink-main) 0%, var(--pink-light) 100%);
      --mascot-shadow: rgba(255, 182, 217, 0.3);
    }

    .skin-sheep {
      --pink-light: #fff8e8;
      --pink-main: #f0d9a0;
      --pink-dark: #d4b896;
      --lavender: #f5e6c8;
      --lavender-dark: #d9c4a0;
      --bg-dark: #1a1815;
      --bg-mid: #2d2820;
      --text-light: #fff8e8;
      --text-muted: #c4b8a0;
      --mascot-body: radial-gradient(ellipse at 30% 30%, #fffef8 0%, #f5edd8 50%, #ebe0c8 100%);
      --mascot-ear-inner: linear-gradient(180deg, #e8d0a0 0%, #fff8e8 100%);
      --mascot-shadow: rgba(240, 217, 160, 0.3);
    }

    .skin-pegasus {
      --pink-light: #e8f8ff;
      --pink-main: #7dd3e8;
      --pink-dark: #4db8d0;
      --lavender: #c8e8f5;
      --lavender-dark: #90c8d8;
      --bg-dark: #101820;
      --bg-mid: #1a2d3d;
      --text-light: #e8f8ff;
      --text-muted: #a0c4cc;
      --mascot-body: radial-gradient(ellipse at 30% 30%, #ffffff 0%, #e0f4f8 50%, #c8e8f0 100%);
      --mascot-ear-inner: linear-gradient(180deg, #7dd3e8 0%, #e8f8ff 100%);
      --mascot-shadow: rgba(125, 211, 232, 0.3);
    }

    .skin-polarbear {
      --pink-light: #f8e8e8;
      --pink-main: #d4a0a8;
      --pink-dark: #c08890;
      --lavender: #e8d0d4;
      --lavender-dark: #c4a0a8;
      --bg-dark: #181518;
      --bg-mid: #2d2028;
      --text-light: #f8e8e8;
      --text-muted: #c4a8b0;
      --mascot-body: radial-gradient(ellipse at 30% 30%, #fffefa 0%, #f0e8e8 50%, #e8dce0 100%);
      --mascot-ear-inner: linear-gradient(180deg, #d4a0a8 0%, #f8e8e8 100%);
      --mascot-shadow: rgba(212, 160, 168, 0.3);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Zen Maru Gothic', sans-serif;
      background: linear-gradient(180deg, var(--bg-dark) 0%, var(--bg-mid) 50%, var(--bg-dark) 100%);
      min-height: 100vh;
      color: var(--text-light);
      padding: 20px;
      padding-bottom: 100px;
      transition: background 0.5s ease;
    }

    /* „Çπ„Ç≠„É≥Âàá„ÇäÊõø„Åà„Éú„Çø„É≥ */
    .skin-switcher {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .skin-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 3px solid rgba(255, 255, 255, 0.3);
      font-size: 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .skin-btn:hover {
      transform: scale(1.1);
    }

    .skin-btn.active {
      border-color: var(--pink-main);
      box-shadow: 0 0 15px var(--mascot-shadow);
    }

    .skin-btn.rabbit {
      background: linear-gradient(135deg, #ffb6d9, #e8d4f0);
    }

    .skin-btn.sheep {
      background: linear-gradient(135deg, #f0d9a0, #f5e6c8);
    }

    .skin-btn.pegasus {
      background: linear-gradient(135deg, #7dd3e8, #c8e8f5);
    }

    .skin-btn.polarbear {
      background: linear-gradient(135deg, #d4a0a8, #e8d0d4);
    }

    /* Êòü„ÅÆËÉåÊôØ */
    .stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
      z-index: 0;
    }

    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 2s ease-in-out infinite;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
    }

    .container {
      max-width: 400px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    /* „É¢„Ç≥„É¢„Ç≥„Éû„Çπ„Ç≥„ÉÉ„Éà */
    .mascot-container {
      text-align: center;
      margin-bottom: 20px;
      position: relative;
    }

    .mascot {
      width: 120px;
      height: 100px;
      position: relative;
      margin: 0 auto;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .mascot-body {
      width: 100px;
      height: 80px;
      background: var(--mascot-body);
      border-radius: 50px 50px 45px 45px;
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: 
        0 10px 30px var(--mascot-shadow),
        inset 0 -10px 20px rgba(232, 212, 240, 0.5);
      transition: all 0.5s ease;
    }

    /* „ÅÜ„Åï„Åé„ÅÆËÄ≥ */
    .mascot-ear {
      width: 25px;
      height: 35px;
      background: var(--mascot-body);
      border-radius: 50% 50% 45% 45%;
      position: absolute;
      top: 0;
      transition: all 0.5s ease;
    }

    .mascot-ear.left {
      left: 15px;
      transform: rotate(-15deg);
    }

    .mascot-ear.right {
      right: 15px;
      transform: rotate(15deg);
    }

    .mascot-ear-inner {
      width: 12px;
      height: 18px;
      background: var(--mascot-ear-inner);
      border-radius: 50%;
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      transition: all 0.5s ease;
    }

    /* „Å≤„Å§„ÅòÁî®Ôºö„ÇÇ„Åì„ÇÇ„ÅìÈ†≠ */
    .sheep-fluff {
      display: none;
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 40px;
    }

    .skin-sheep .sheep-fluff {
      display: block;
    }

    .skin-sheep .mascot-ear {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      top: 15px;
    }

    .skin-sheep .mascot-ear.left {
      left: 5px;
    }

    .skin-sheep .mascot-ear.right {
      right: 5px;
    }

    .skin-sheep .mascot-ear-inner {
      width: 10px;
      height: 10px;
      top: 5px;
    }

    .fluff-ball {
      position: absolute;
      background: var(--mascot-body);
      border-radius: 50%;
      box-shadow: 0 2px 10px var(--mascot-shadow);
    }

    /* „Éö„Ç¨„Çµ„ÇπÁî®ÔºöËßí„Å®Áøº */
    .pegasus-horn {
      display: none;
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 8px solid transparent;
      border-right: 8px solid transparent;
      border-bottom: 30px solid var(--pink-main);
    }

    .skin-pegasus .pegasus-horn {
      display: block;
    }

    .skin-pegasus .mascot-ear {
      width: 15px;
      height: 25px;
      border-radius: 5px 20px 5px 5px;
    }

    .skin-pegasus .mascot-ear.left {
      transform: rotate(-30deg);
    }

    .skin-pegasus .mascot-ear.right {
      transform: rotate(30deg);
    }

    .pegasus-wing {
      display: none;
      position: absolute;
      top: 25px;
      width: 30px;
      height: 40px;
      background: linear-gradient(180deg, rgba(255,255,255,0.9) 0%, var(--pink-light) 100%);
      border-radius: 50% 50% 20% 20%;
    }

    .skin-pegasus .pegasus-wing {
      display: block;
    }

    .pegasus-wing.left {
      left: -20px;
      transform: rotate(20deg);
    }

    .pegasus-wing.right {
      right: -20px;
      transform: rotate(-20deg);
    }

    /* „Ç∑„É≠„ÇØ„ÉûÁî®Ôºö‰∏∏„ÅÑËÄ≥ */
    .skin-polarbear .mascot-ear {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      top: 5px;
    }

    .skin-polarbear .mascot-ear-inner {
      width: 15px;
      height: 15px;
      top: 5px;
    }

    .mascot-eyes {
      position: absolute;
      top: 35px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 20px;
    }

    .mascot-eye {
      width: 8px;
      height: 12px;
      background: #2d1f3d;
      border-radius: 50%;
      animation: blink 4s ease-in-out infinite;
    }

    @keyframes blink {
      0%, 90%, 100% { transform: scaleY(1); }
      95% { transform: scaleY(0.1); }
    }

    .mascot-cheek {
      width: 15px;
      height: 10px;
      background: var(--pink-main);
      border-radius: 50%;
      position: absolute;
      top: 45px;
      opacity: 0.6;
      transition: all 0.5s ease;
    }

    .mascot-cheek.left { left: 22px; }
    .mascot-cheek.right { right: 22px; }

    .mascot-mouth {
      width: 8px;
      height: 4px;
      border: 2px solid #2d1f3d;
      border-top: none;
      border-radius: 0 0 10px 10px;
      position: absolute;
      top: 52px;
      left: 50%;
      transform: translateX(-50%);
    }

    .greeting {
      font-size: 1.1rem;
      color: var(--pink-main);
      margin-top: 10px;
      text-shadow: 0 0 20px var(--mascot-shadow);
      transition: all 0.5s ease;
    }

    /* „Ç´„Éº„Éâ */
    .card {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      border-radius: 25px;
      padding: 20px;
      margin-bottom: 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      transition: all 0.5s ease;
    }

    .card-title {
      font-size: 0.9rem;
      color: var(--lavender);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.5s ease;
    }

    .card-title::before {
      content: '‚úß';
      color: var(--pink-main);
    }

    /* Ê∞óÂàÜ„Çπ„É©„Ç§„ÉÄ„Éº */
    .mood-container {
      text-align: center;
    }

    .mood-value {
      font-size: 3rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--pink-main), var(--lavender));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
    }

    .mood-slider {
      width: 100%;
      height: 12px;
      -webkit-appearance: none;
      appearance: none;
      background: linear-gradient(90deg, var(--lavender-dark), var(--pink-main), var(--pink-dark));
      border-radius: 10px;
      outline: none;
      margin: 10px 0;
      transition: all 0.5s ease;
    }

    .mood-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 30px;
      height: 30px;
      background: white;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 4px 15px var(--mascot-shadow);
      border: 3px solid var(--pink-main);
      transition: all 0.5s ease;
    }

    .mood-labels {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* Êï∞ÂÄ§ÂÖ•Âäõ */
    .number-input-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    .number-input {
      width: 120px;
      padding: 15px;
      font-size: 1.5rem;
      font-family: 'Zen Maru Gothic', sans-serif;
      text-align: center;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid var(--pink-main);
      border-radius: 15px;
      color: var(--text-light);
      outline: none;
      transition: all 0.3s ease;
    }

    .number-input:focus {
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 0 20px var(--mascot-shadow);
    }

    .unit {
      font-size: 1rem;
      color: var(--lavender);
    }

    /* „ÉÜ„Ç≠„Çπ„Éà„Ç®„É™„Ç¢ */
    .diary-textarea {
      width: 100%;
      min-height: 100px;
      padding: 15px;
      font-family: 'Zen Maru Gothic', sans-serif;
      font-size: 1rem;
      background: rgba(255, 255, 255, 0.08);
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 15px;
      color: var(--text-light);
      outline: none;
      resize: vertical;
      transition: all 0.3s ease;
    }

    .diary-textarea:focus {
      border-color: var(--pink-main);
      box-shadow: 0 0 20px var(--mascot-shadow);
    }

    .diary-textarea::placeholder {
      color: var(--text-muted);
    }

    /* „ÇÑ„ÇäÊÆã„Åó„Ç≥„Éº„Éä„Éº */
    .leftover-card {
      border: 2px dashed var(--lavender-dark);
      background: rgba(255, 255, 255, 0.05);
    }

    .leftover-card .card-title::before {
      content: 'üåô';
    }

    .mic-hint {
      font-size: 0.75rem;
      color: var(--text-muted);
      text-align: center;
      margin-top: 8px;
    }

    /* „Çø„Ç∞ */
    .tags-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }

    .tag {
      padding: 8px 15px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--pink-main);
      border-radius: 20px;
      font-size: 0.85rem;
      color: var(--pink-light);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .tag:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.05);
    }

    .tag.selected {
      background: var(--pink-main);
      color: var(--bg-dark);
      font-weight: 500;
    }

    .tag-input-row {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .tag-input {
      flex: 1;
      padding: 10px 15px;
      font-family: 'Zen Maru Gothic', sans-serif;
      font-size: 0.9rem;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 15px;
      color: var(--text-light);
      outline: none;
    }

    .tag-input::placeholder {
      color: var(--text-muted);
    }

    .add-tag-btn {
      padding: 10px 20px;
      background: var(--lavender-dark);
      border: none;
      border-radius: 15px;
      color: var(--bg-dark);
      font-family: 'Zen Maru Gothic', sans-serif;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .add-tag-btn:hover {
      background: var(--lavender);
      transform: scale(1.05);
    }

    /* ‰øùÂ≠ò„Éú„Çø„É≥ */
    .save-btn {
      width: 100%;
      padding: 18px;
      font-family: 'Zen Maru Gothic', sans-serif;
      font-size: 1.2rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--pink-main), var(--pink-dark));
      border: none;
      border-radius: 25px;
      color: white;
      cursor: pointer;
      box-shadow: 0 10px 30px var(--mascot-shadow);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .save-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 40px var(--mascot-shadow);
    }

    .save-btn:active {
      transform: translateY(0);
    }

    .save-btn::after {
      content: '‚úß „Åç„Çç„Åè„Åô„Çã ‚úß';
    }

    /* ÊàêÂäüÊºîÂá∫ */
    .success-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(26, 21, 32, 0.9);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 100;
      animation: fadeIn 0.3s ease;
    }

    .success-overlay.show {
      display: flex;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .success-content {
      text-align: center;
      animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes popIn {
      from { transform: scale(0.5); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .success-mascot {
      font-size: 5rem;
      margin-bottom: 20px;
      animation: bounce 0.6s ease infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .success-text {
      font-size: 1.5rem;
      color: var(--pink-main);
      text-shadow: 0 0 30px var(--mascot-shadow);
    }

    .success-sub {
      font-size: 1rem;
      color: var(--lavender);
      margin-top: 10px;
    }

    .sparkles {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .sparkle {
      position: absolute;
      font-size: 2rem;
      animation: sparkle 1s ease forwards;
    }

    @keyframes sparkle {
      0% { transform: scale(0) rotate(0deg); opacity: 1; }
      100% { transform: scale(1.5) rotate(180deg); opacity: 0; }
    }

    /* Êó•‰ªòË°®Á§∫ */
    .date-display {
      text-align: center;
      font-size: 0.9rem;
      color: var(--lavender);
      margin-bottom: 20px;
    }

    /* „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏ */
    .error-msg {
      background: rgba(255, 100, 100, 0.2);
      border: 1px solid rgba(255, 100, 100, 0.5);
      border-radius: 10px;
      padding: 10px 15px;
      margin-bottom: 15px;
      font-size: 0.85rem;
      color: #ffb0b0;
      display: none;
    }

    .error-msg.show {
      display: block;
    }

    /* Ë®≠ÂÆö„Çª„ÇØ„Ç∑„Éß„É≥ */
    .settings-section {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .settings-title {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 15px;
      text-align: center;
    }

    .gas-url-input {
      width: 100%;
      padding: 12px 15px;
      font-family: 'Zen Maru Gothic', sans-serif;
      font-size: 0.85rem;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      color: var(--text-light);
      outline: none;
    }

    .gas-url-input::placeholder {
      color: var(--text-muted);
    }

    .gas-status {
      margin-top: 10px;
      font-size: 0.8rem;
      text-align: center;
    }

    .gas-status.connected {
      color: #90EE90;
    }

    .gas-status.not-connected {
      color: var(--text-muted);
    }
  </style>
</head>
<body>
  <!-- Êòü„ÅÆËÉåÊôØ -->
  <div class="stars" id="stars"></div>

  <div class="container">
    <!-- „Çπ„Ç≠„É≥Âàá„ÇäÊõø„Åà -->
    <div class="skin-switcher">
      <button class="skin-btn rabbit active" data-skin="rabbit" title="„ÅÜ„Åï„Åé">üê∞</button>
      <button class="skin-btn sheep" data-skin="sheep" title="„Å≤„Å§„Åò">üêë</button>
      <button class="skin-btn pegasus" data-skin="pegasus" title="„Éö„Ç¨„Çµ„Çπ">ü¶Ñ</button>
      <button class="skin-btn polarbear" data-skin="polarbear" title="„Ç∑„É≠„ÇØ„Éû">üêª‚Äç‚ùÑÔ∏è</button>
    </div>

    <!-- „Éû„Çπ„Ç≥„ÉÉ„Éà -->
    <div class="mascot-container">
      <div class="mascot">
        <!-- „Éö„Ç¨„Çµ„Çπ„ÅÆËßí -->
        <div class="pegasus-horn"></div>
        
        <!-- „Å≤„Å§„Åò„ÅÆ„ÇÇ„Åì„ÇÇ„Åì -->
        <div class="sheep-fluff">
          <div class="fluff-ball" style="width: 25px; height: 25px; top: 10px; left: 5px;"></div>
          <div class="fluff-ball" style="width: 30px; height: 28px; top: 5px; left: 25px;"></div>
          <div class="fluff-ball" style="width: 25px; height: 25px; top: 10px; left: 50px;"></div>
        </div>
        
        <div class="mascot-ear left">
          <div class="mascot-ear-inner"></div>
        </div>
        <div class="mascot-ear right">
          <div class="mascot-ear-inner"></div>
        </div>
        
        <!-- „Éö„Ç¨„Çµ„Çπ„ÅÆÁøº -->
        <div class="pegasus-wing left"></div>
        <div class="pegasus-wing right"></div>
        
        <div class="mascot-body">
          <div class="mascot-eyes">
            <div class="mascot-eye"></div>
            <div class="mascot-eye"></div>
          </div>
          <div class="mascot-cheek left"></div>
          <div class="mascot-cheek right"></div>
          <div class="mascot-mouth"></div>
        </div>
      </div>
      <p class="greeting" id="greeting">„Åä„Å§„Åã„Çå„Åï„Åæ ‚úß</p>
    </div>

    <!-- Êó•‰ªò -->
    <div class="date-display" id="dateDisplay"></div>

    <!-- „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏ -->
    <div class="error-msg" id="errorMsg"></div>

    <!-- Ê∞óÂàÜ -->
    <div class="card">
      <div class="card-title">„Åç„Çá„ÅÜ„ÅÆÊ∞óÂàÜ</div>
      <div class="mood-container">
        <div class="mood-value" id="moodValue">5</div>
        <input type="range" class="mood-slider" id="moodSlider" min="1" max="10" value="5">
        <div class="mood-labels">
          <span>üò¢</span>
          <span>üòê</span>
          <span>üòä</span>
        </div>
      </div>
    </div>

    <!-- ‰ΩìÈáç -->
    <div class="card">
      <div class="card-title">‰ΩìÈáç</div>
      <div class="number-input-container">
        <input type="number" class="number-input" id="weightInput" placeholder="00.0" step="0.1">
        <span class="unit">kg</span>
      </div>
    </div>

    <!-- Ê≠©Êï∞ -->
    <div class="card">
      <div class="card-title">Ê≠©Êï∞</div>
      <div class="number-input-container">
        <input type="number" class="number-input" id="stepsInput" placeholder="0" step="1">
        <span class="unit">Ê≠©</span>
      </div>
    </div>

    <!-- Êó•Ë®ò -->
    <div class="card">
      <div class="card-title">„Å≤„Å®„Åì„Å®Êó•Ë®ò</div>
      <textarea class="diary-textarea" id="diaryInput" placeholder="‰ªäÊó•„ÅÇ„Å£„Åü„Åì„Å®„ÇíÊõ∏„ÅÑ„Å¶„Å≠..."></textarea>
    </div>

    <!-- „ÇÑ„ÇäÊÆã„Åó„Ç≥„Éº„Éä„Éº -->
    <div class="card leftover-card">
      <div class="card-title">„ÇÑ„ÇäÊÆã„Åó„ÉªÊòéÊó•„ÇÑ„Çã„Åì„Å®</div>
      <textarea class="diary-textarea" id="leftoverInput" placeholder="È†≠„ÅÆ‰∏≠„ÇíÁ©∫„Å£„ÅΩ„Å´„Åó„Å¶„Åê„Å£„Åô„ÇäÁú†„Çç„ÅÜ..."></textarea>
      <div class="mic-hint">üí° „Ç≠„Éº„Éú„Éº„Éâ„ÅÆüé§„Éû„Ç§„ÇØ„ÅßÈü≥Â£∞ÂÖ•Âäõ„Åß„Åç„Çã„Çà</div>
    </div>

    <!-- „Çø„Ç∞ -->
    <div class="card">
      <div class="card-title">„Çø„Ç∞</div>
      <div class="tags-container" id="tagsContainer"></div>
      <div class="tag-input-row">
        <input type="text" class="tag-input" id="newTagInput" placeholder="Êñ∞„Åó„ÅÑ„Çø„Ç∞...">
        <button class="add-tag-btn" id="addTagBtn">ËøΩÂä†</button>
      </div>
    </div>

    <!-- ‰øùÂ≠ò„Éú„Çø„É≥ -->
    <button class="save-btn" id="saveBtn"></button>

    <!-- Ë®≠ÂÆö -->
    <div class="settings-section">
      <div class="settings-title">‚úß Google Apps Script Ë®≠ÂÆö ‚úß</div>
      <input type="text" class="gas-url-input" id="gasUrlInput" placeholder="GAS„ÅÆ„Ç¶„Çß„Éñ„Ç¢„Éó„É™URL„ÇíË≤º„Çä‰ªò„Åë...">
      <div class="gas-status not-connected" id="gasStatus">Êú™Êé•Á∂ö</div>
    </div>
  </div>

  <!-- ÊàêÂäüÊºîÂá∫ -->
  <div class="success-overlay" id="successOverlay">
    <div class="sparkles" id="sparkles"></div>
    <div class="success-content">
      <div class="success-mascot" id="successMascot">üê∞‚ú®</div>
      <div class="success-text">„Åç„Çç„Åè„Åß„Åç„Åü„ÇàÔºÅ</div>
      <div class="success-sub">„Åà„Çâ„ÅÑÔºÅ„Åä„ÇÑ„Åô„Åø„Å™„Åï„ÅÑ ‚úß</div>
    </div>
  </div>

  <script>
    // „Çπ„Ç≠„É≥ÁÆ°ÁêÜ
    const skinEmojis = {
      rabbit: 'üê∞‚ú®',
      sheep: 'üêë‚ú®',
      pegasus: 'ü¶Ñ‚ú®',
      polarbear: 'üêª‚Äç‚ùÑÔ∏è‚ú®'
    };

    let currentSkin = localStorage.getItem('yumekawa_skin') || 'rabbit';

    function setSkin(skin) {
      currentSkin = skin;
      localStorage.setItem('yumekawa_skin', skin);
      
      // body„ÅÆ„ÇØ„É©„Çπ„ÇíÊõ¥Êñ∞
      document.body.className = '';
      if (skin !== 'rabbit') {
        document.body.classList.add('skin-' + skin);
      }
      
      // „Éú„Çø„É≥„ÅÆactive„ÇíÊõ¥Êñ∞
      document.querySelectorAll('.skin-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.skin === skin) {
          btn.classList.add('active');
        }
      });
      
      // ÊàêÂäüÊôÇ„ÅÆÁµµÊñáÂ≠ó„ÇíÊõ¥Êñ∞
      document.getElementById('successMascot').textContent = skinEmojis[skin];
    }

    // „Çπ„Ç≠„É≥„Éú„Çø„É≥„ÅÆ„Ç§„Éô„É≥„Éà
    document.querySelectorAll('.skin-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        setSkin(btn.dataset.skin);
      });
    });

    // ‰øùÂ≠ò„Åï„Çå„Åü„Çπ„Ç≠„É≥„ÇíÈÅ©Áî®
    setSkin(currentSkin);

    // Êòü„ÅÆÁîüÊàê
    function createStars() {
      const starsContainer = document.getElementById('stars');
      for (let i = 0; i < 50; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.width = (Math.random() * 3 + 1) + 'px';
        star.style.height = star.style.width;
        star.style.animationDelay = Math.random() * 2 + 's';
        starsContainer.appendChild(star);
      }
    }
    createStars();

    // Êó•‰ªòË°®Á§∫
    function updateDate() {
      const now = new Date();
      const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
      document.getElementById('dateDisplay').textContent = now.toLocaleDateString('ja-JP', options);
    }
    updateDate();

    // Êå®Êã∂
    function updateGreeting() {
      const hour = new Date().getHours();
      const greetingEl = document.getElementById('greeting');
      if (hour >= 5 && hour < 12) {
        greetingEl.textContent = '„Åä„ÅØ„Çà„ÅÜ ‚úß';
      } else if (hour >= 12 && hour < 18) {
        greetingEl.textContent = '„Åì„Çì„Å´„Å°„ÅØ ‚úß';
      } else {
        greetingEl.textContent = '„Åä„Å§„Åã„Çå„Åï„Åæ ‚úß';
      }
    }
    updateGreeting();

    // Ê∞óÂàÜ„Çπ„É©„Ç§„ÉÄ„Éº
    const moodSlider = document.getElementById('moodSlider');
    const moodValue = document.getElementById('moodValue');
    moodSlider.addEventListener('input', () => {
      moodValue.textContent = moodSlider.value;
    });

    // „Çø„Ç∞ÁÆ°ÁêÜ
    let availableTags = JSON.parse(localStorage.getItem('yumekawa_tags')) || ['#Ë≤∑„Å£„ÅüÁâ©', '#ÈÅãÂãï„Åó„Åü', '#„Çà„ÅèÂØù„Åü', '#„Åå„Çì„Å∞„Å£„Åü'];
    let selectedTags = [];

    function renderTags() {
      const container = document.getElementById('tagsContainer');
      container.innerHTML = '';
      availableTags.forEach(tag => {
        const tagEl = document.createElement('div');
        tagEl.className = 'tag' + (selectedTags.includes(tag) ? ' selected' : '');
        tagEl.textContent = tag;
        tagEl.addEventListener('click', () => toggleTag(tag));
        container.appendChild(tagEl);
      });
    }

    function toggleTag(tag) {
      if (selectedTags.includes(tag)) {
        selectedTags = selectedTags.filter(t => t !== tag);
      } else {
        selectedTags.push(tag);
      }
      renderTags();
    }

    function addNewTag() {
      const input = document.getElementById('newTagInput');
      let newTag = input.value.trim();
      if (!newTag) return;
      
      if (!newTag.startsWith('#')) {
        newTag = '#' + newTag;
      }
      
      if (!availableTags.includes(newTag)) {
        availableTags.push(newTag);
        localStorage.setItem('yumekawa_tags', JSON.stringify(availableTags));
      }
      
      selectedTags.push(newTag);
      input.value = '';
      renderTags();
    }

    document.getElementById('addTagBtn').addEventListener('click', addNewTag);
    document.getElementById('newTagInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') addNewTag();
    });

    renderTags();

    // GAS URLÁÆ°ÁêÜ
    const gasUrlInput = document.getElementById('gasUrlInput');
    const gasStatus = document.getElementById('gasStatus');
    
    const savedGasUrl = localStorage.getItem('yumekawa_gas_url');
    if (savedGasUrl) {
      gasUrlInput.value = savedGasUrl;
      gasStatus.textContent = 'Êé•Á∂öÊ∏à„Åø ‚úì';
      gasStatus.className = 'gas-status connected';
    }

    gasUrlInput.addEventListener('change', () => {
      const url = gasUrlInput.value.trim();
      if (url) {
        localStorage.setItem('yumekawa_gas_url', url);
        gasStatus.textContent = 'Êé•Á∂öÊ∏à„Åø ‚úì';
        gasStatus.className = 'gas-status connected';
      } else {
        localStorage.removeItem('yumekawa_gas_url');
        gasStatus.textContent = 'Êú™Êé•Á∂ö';
        gasStatus.className = 'gas-status not-connected';
      }
    });

    // „Çπ„Éë„Éº„ÇØ„É´ÊºîÂá∫
    function createSparkles() {
      const container = document.getElementById('sparkles');
      container.innerHTML = '';
      const emojis = ['‚úß', '‚ú¶', '‚ãÜ', '‚ú©', '‚ô°', '‚ùÄ'];
      for (let i = 0; i < 15; i++) {
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
        sparkle.style.left = Math.random() * 100 + '%';
        sparkle.style.top = Math.random() * 100 + '%';
        sparkle.style.animationDelay = Math.random() * 0.5 + 's';
        container.appendChild(sparkle);
      }
    }

    // ‰øùÂ≠òÂá¶ÁêÜ
    document.getElementById('saveBtn').addEventListener('click', async () => {
      const gasUrl = localStorage.getItem('yumekawa_gas_url');
      const errorMsg = document.getElementById('errorMsg');
      
      const data = {
        date: new Date().toISOString(),
        mood: moodSlider.value,
        weight: document.getElementById('weightInput').value || '',
        steps: document.getElementById('stepsInput').value || '',
        diary: document.getElementById('diaryInput').value || '',
        leftover: document.getElementById('leftoverInput').value || '',
        tags: selectedTags.join(', ')
      };

      if (!gasUrl) {
        // GASÊú™Ë®≠ÂÆö„ÅÆÂ†¥Âêà„ÅØ„É≠„Éº„Ç´„É´‰øùÂ≠ò„ÅÆ„Åø
        const localData = JSON.parse(localStorage.getItem('yumekawa_records') || '[]');
        localData.push(data);
        localStorage.setItem('yumekawa_records', JSON.stringify(localData));
        
        showSuccess();
        return;
      }

      try {
        // URL„Éë„É©„É°„Éº„Çø„Å®„Åó„Å¶ÈÄÅ‰ø°
        const params = new URLSearchParams();
        params.append('date', data.date);
        params.append('mood', data.mood);
        params.append('weight', data.weight);
        params.append('steps', data.steps);
        params.append('diary', data.diary);
        params.append('leftover', data.leftover);
        params.append('tags', data.tags);

        // iframe„Çí‰Ωø„Å£„ÅüÈÄÅ‰ø°ÔºàCORS„ÇíÂõûÈÅøÔºâ
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.name = 'gas_iframe';
        document.body.appendChild(iframe);

        const form = document.createElement('form');
        form.method = 'GET';
        form.action = gasUrl;
        form.target = 'gas_iframe';

        for (const [key, value] of Object.entries(data)) {
          const input = document.createElement('input');
          input.type = 'hidden';
          input.name = key;
          input.value = value;
          form.appendChild(input);
        }

        document.body.appendChild(form);
        form.submit();

        // Â∞ë„ÅóÂæÖ„Å£„Å¶„Åã„ÇâÊàêÂäü„Å®„Åø„Å™„Åô
        setTimeout(() => {
          document.body.removeChild(form);
          document.body.removeChild(iframe);
          showSuccess();
          
          // „É≠„Éº„Ç´„É´„Å´„ÇÇ‰øùÂ≠ò
          const localData = JSON.parse(localStorage.getItem('yumekawa_records') || '[]');
          localData.push(data);
          localStorage.setItem('yumekawa_records', JSON.stringify(localData));
        }, 1500);
        
      } catch (error) {
        errorMsg.textContent = '‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü...„ÇÇ„ÅÜ‰∏ÄÂ∫¶Ë©¶„Åó„Å¶„Å≠';
        errorMsg.className = 'error-msg show';
        setTimeout(() => {
          errorMsg.className = 'error-msg';
        }, 3000);
      }
    });

    function showSuccess() {
      const overlay = document.getElementById('successOverlay');
      createSparkles();
      overlay.className = 'success-overlay show';
      
      setTimeout(() => {
        overlay.className = 'success-overlay';
        // „Éï„Ç©„Éº„É†„É™„Çª„ÉÉ„Éà
        document.getElementById('weightInput').value = '';
        document.getElementById('stepsInput').value = '';
        document.getElementById('diaryInput').value = '';
        document.getElementById('leftoverInput').value = '';
        moodSlider.value = 5;
        moodValue.textContent = '5';
        selectedTags = [];
        renderTags();
      }, 2500);
    }
  </script>
</body>
</html>
